<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>vocabcards</title>
<link rel="stylesheet" href="style.css" />
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

<!-- Â∑¶„É°„Éã„É•„Éº -->
<div id="menu">
  <div class="menu-group">
    <div class="menu-parent" onclick="toggleMenu(this)">‚ñ∏Ëã±Ë™û</div>
    <div class="menu-children">
      <div class="menu-item" onclick="changeSheet(0)">ÂíåË®≥</div>
      <div class="menu-item" onclick="changeSheet(1)">Ëã±Ë®≥</div>
      <div class="menu-item" onclick="changeSheet(2)">Èõ£Ë™û</div>
    </div>
  </div>

  <div class="menu-group">
    <div class="menu-parent" onclick="toggleMenu(this)">‚ñ∏Âè§ÂÖ∏</div>
    <div class="menu-children">
      <div class="menu-item" onclick="changeSheet(3)">Âè§Êñá</div>
      <div class="menu-item" onclick="changeSheet(4)">Êº¢Êñá</div>
    </div>
  </div>
</div>

<!-- Âè≥‰∏ä„Ç¢„Ç§„Ç≥„É≥Áæ§ -->
    <div id="topControls">
      <button id="batchBtn" class="icon-btn" onclick="openBatchEditor()">List</button>
      <button id="saveAllBtn" class="save-btn" onclick="saveAll()">Save</button>
    </div>

<!-- „É°„Ç§„É≥ -->
<div id="main">
  <div id="app">

    <!-- „Ç´„Éº„Éâ -->
    <div id="card" class="card">
      <!-- „Éï„Ç£„É´„Çø„Éë„Éç„É´ -->
      <div id="filterPanel" class="panel" style="display:none;">
        <h4>Filter</h4>
        <label><input type="checkbox" class="filterCheckbox" data-lv="1" checked /> Lv1</label><br/>
        <label><input type="checkbox" class="filterCheckbox" data-lv="2" checked /> Lv2</label><br/>
        <label><input type="checkbox" class="filterCheckbox" data-lv="3" checked /> Lv3</label><br/>
        <label><input type="checkbox" class="filterCheckbox" data-lv="4" checked /> Lv4</label><br/>
        <label><input type="checkbox" class="filterCheckbox" data-lv="5" checked /> Lv5</label>
      </div>
      <button class="filter no-flip" onclick="toggleFilterPanel()">‚ò∞</button> 
      <div class="card-inner" id="cardInner">
        <div class="face front">
          <div class="face-top">
            <button class="icon-small no-flip" onclick="addNewCard()">Ôºã</button>
            <button class="icon-small no-flip" id="editBtn" title="Edit" onclick="openEditPopup()">üñä</button>                      
          </div>
          <div class="face-content" id="front"></div>
          <div class="face-bottom">
            <div id="levelBadge" class="level-badge no-flip" onclick="toggleLevelSelector()">Lv<span id="levelVal">3</span> ‚ñæ</div>
            <div id="levelSelector" class="level-selector" style="display:none;">
              <div class="level-item no-flip" onclick="setCardLevel(1)">1</div>
              <div class="level-item no-flip" onclick="setCardLevel(2)">2</div>
              <div class="level-item no-flip" onclick="setCardLevel(3)">3</div>
              <div class="level-item no-flip" onclick="setCardLevel(4)">4</div>
              <div class="level-item no-flip" onclick="setCardLevel(5)">5</div>
            </div>
          </div>
        </div>

        <div class="face back">
          <div class="face-top">
            <button class="icon-small no-flip" id="editBtnBack" title="Edit" onclick="openEditPopup()">üñä</button>
          </div>
          <div class="face-content" id="back"></div>
        </div>
      </div>
    </div>

    <!-- controls -->
    <div class="controls">
      <button class="rounded" onclick="prev(); event.stopPropagation()">‚Üê</button>
      <button class="rounded" onclick="next(); event.stopPropagation()">‚Üí</button>
    </div>

    <!-- „Çπ„É©„Ç§„ÉÄ„Éº -->
    <input type="range" id="cardSlider" min="0" max="0" value="0" style="width:100%; margin-top:16px;" />

    <!-- ÊûöÊï∞Ë°®Á§∫ -->
    <div id="cardCount" style="margin-top:8px; font-size:14px;"></div>

  </div>
</div>

<!-- Á∑®ÈõÜ„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
<div id="editPopup" class="modal" style="display:none;">
  <div class="modal-content">
    <button class="modal-close" onclick="closeEditPopup()">√ó</button>
    <label>Front<br/>
      <textarea id="editFront" class="modal-textbox"rows="2"></textarea>
    </label>
    <label>Back<br/>
      <textarea id="editBack" class="modal-textbox"rows="2"></textarea>
    </label>
    <label>Level
      <select id="editLevel" class="modal-select">
        <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
      </select>
    </label>
    <div class="modal-actions">
      <button class="rounded" onclick="applyEdit()">Apply</button>
      <button id="deleteBtn" class="rounded" onclick="deleteCurrentCard()">Delete</button>
    </div>
  </div>
</div>

<!-- „Éê„ÉÉ„ÉÅÁ∑®ÈõÜ„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
<div id="batchPopup" class="modal large" style="display:none;">
  <div class="modal-content">
    <h3>Batch Edit</h3>
    <div style="display:flex; gap:8px;  margin-bottom:0px;">
      <input id="batchSearch" placeholder="Search (Front/Back)" class="patch_bar" oninput="renderBatchList()" />
      <select id="batchFilterLevel" class="patch_bar" onchange="renderBatchList()">
        <option value="">All Levels</option>
        <option value="1">Lv1</option>
        <option value="2">Lv2</option>
        <option value="3">Lv3</option>
        <option value="4">Lv4</option>
        <option value="5">Lv5</option>
      </select>
      <button class="modal-close" onclick="closeBatchEditor()">√ó</button>
    </div>

    <div id="batchList" class="batch-list"></div>

    <div id="batchBottomBar" style="margin-top:8px; display:flex; gap:8px;">
      <button id="batchSelectBtn" class="rounded" onclick="toggleBatchSelectMode()">Multi-select</button>
      <button id="batchRunBtn" class="rounded hidden" onclick="runBatchAction()">Apply to selected</button>
    </div>
  </div>
</div>

<div id="batchModeModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3>Batch Actions</h3>
    <button class="modal-close" onclick="closeBatchModeModal()">√ó</button>
    <button class="rounded" onclick="startBatchLevel()">Change levels</button>
    <button class="rounded" onclick="startBatchDelete()">Delete selected</button>

    <div id="batchLevelChooser" style="display:none; margin-top:12px;">
      <select id="batchLevelTarget" class="modal-select">
        <option value="1">Lv1</option>
        <option value="2">Lv2</option>
        <option value="3">Lv3</option>
        <option value="4">Lv4</option>
        <option value="5">Lv5</option>
      </select>
      <button class="rounded" onclick="confirmBatchLevel()">Set to this level</button>
    </div>
  </div>
</div>


<!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞ -->
<div id="loading" style="display:none;">
  <div class="spinner"></div>
</div>

<script src="app.js"></script>
</body>
</html>
